# Kokoro TTS Brave Addon

A Brave browser addon (or any Chromium-based browser) that allows you to select text on any web page and play speech generated by a local Kokoro TTS server (using Kokoro-FastAPI).

## Features

*   **Text Selection**: Select any text on a web page.
*   **Context Menu**: "Kokoro TTS" option available when right-clicking on selected text.
*   **Kokoro-FastAPI Integration**: Sends selected text to your local Kokoro-FastAPI server.
*   **Audio Playback**: Plays the generated WAV audio directly in the browser.
*   **Manifest V3 Compatibility**: Uses an offscreen document for audio playback, compliant with Manifest V3 Service Worker policies.

## Prerequisites

To use this addon, you need the following:

1.  **Brave Browser** (or Google Chrome, Microsoft Edge, etc.).
2.  **Running Kokoro-FastAPI Server**: This addon connects to a local instance of the [remsky/Kokoro-FastAPI](https://github.com/remsky/Kokoro-FastAPI) server (Dockerized FastAPI wrapper for the Kokoro TTS model).

    ### Kokoro-FastAPI Setup

    To set up and run the Kokoro-FastAPI server:

    a.  **Install Docker Desktop** if you don't have it already.
    b.  **Clone or download** the [remsky/Kokoro-FastAPI](https://github.com/remsky/Kokoro-FastAPI) repository to your computer.
    c.  Open a terminal in the root directory of the `Kokoro-FastAPI` project.
    d.  Build the Docker image (this may take a few minutes the first time):
        ```bash
        docker build -t kokoro-fastapi .
        ```
    e.  Run the Docker container. **Ensure port 8880 is free**:
        ```bash
        docker run -p 8880:8000 --name kokoro-server kokoro-fastapi
        ```
    f.  Verify the server is running by accessing [http://localhost:8880/docs](http://localhost:8880/docs) in your browser. You should see the API documentation.

## Addon Installation

1.  **Download or Clone this addon repository** to your computer.
2.  Open your Brave browser and go to `brave://extensions/`.
3.  Enable **"Developer mode"** (usually a toggle switch in the top right corner).
4.  Click on **"Load unpacked"**.
5.  Select the folder where you downloaded/cloned this addon repository (`Kokoro-addon`).

## How to Use

1.  Ensure the **Kokoro-FastAPI server is running** (as per the setup instructions above, usually at `http://localhost:8880/`).
2.  Open any web page in your Brave browser.
3.  **Select a piece of text** on the page.
4.  **Right-click** on the selected text.
5.  In the context menu, click the **"Kokoro TTS"** option.
6.  The addon will send the text to your local server, generate the audio, and play it.

## Configuration (Optional)

You can adjust some audio options directly in the `background.js` file:

*   `voice`: Currently set to `"pf_dora"`. You can change it to any voice supported by your Kokoro-FastAPI server.
*   `speed`: Currently set to `1`. You can adjust the speech speed.
*   `response_format`: Currently `"wav"`. You can change it to `"mp3"` if preferred (and if the Kokoro-FastAPI server supports it).

## Troubleshooting

*   **"HTTP error! status: XXX"**: Ensure the Kokoro-FastAPI server is running and accessible on port `8880` ([http://localhost:8880/docs](http://localhost:8880/docs)). If the error is `404`, verify the server is configured correctly.
*   **Addon does not appear or does not work**: Check the `brave://extensions/` page. Ensure "Developer mode" is enabled, the addon is listed, and there are no (red) errors beneath it. Try reloading it (circular arrow icon).
*   **No audio**: Check the Developer Tools console (F12) for errors in the `Console` tab of your addon (by clicking on `(Service Worker)` or `offscreen.html`).

## Contribution

Feel free to open issues or pull requests in this repository.

## Acknowledgments

*   [remsky/Kokoro-FastAPI](https://github.com/remsky/Kokoro-FastAPI) - The FastAPI server that does the TTS magic.
*   The base model [Kokoro-TTS](https://huggingface.co/hexgrad/Kokoro-82M).

